<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Courier New'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">— Первым делом, дабы избежать потери информации из-за массовых перекодировок, я бы рекомендовал перевести все имеющиеся форматы в loosless h.265 (или любой другой loseless raw формат, с которым вам удобно работать)<br /><a href="http://trac.ffmpeg.org/wiki/Encode/H.264"><span style=" text-decoration: underline; color:#0000ff;">trac.ffmpeg.org/wiki/Encode/H.264</span></a><br />Запаситесь местом, каждые минута FullHD видео будут занимать ~1.3 Gb.<br /><br />— Склеить видео состоящее из нескольких кусков в один фаил:<br /><span style=" font-family:'Courier New,courier';">echo -e &quot;file './180318AA.mp4'\nfile './180618AA.mp4'&quot; | ffmpeg -f concat -safe 0 -i - -c copy ./dome_full.mp4</span><br /><br />— Вырезать 60 секунд видео со второй минуты 21 секунды (порядок ключей имеет значение):<br /><span style=" font-family:'Courier New,courier';">ffmpeg -i ./AMBA0003.mp4 -ss 02:21 -t 60 -c copy ./carcamq2_1_1.mp4</span><br /><br />— Поворот кадра на 2.5 градуса против часовой стрелки (использовал только для обзорных видео, ибо это вносит искажение в картинку):<br /><span style=" font-family:'Courier New,courier';">ffmpeg -i ./contour_2_1.mp4 -vf &quot;rotate=-2.5*PI/180:ow=iw:oh=ih&quot; -acodec copy ./contour_2_1_rotated.mp4</span><br /><br />— Из видео сохраняем все кадры, из кадров вырезаем только горизонтальную полосу, полосы склеиваем одна под другой в большую картинку:<br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">#convet video to png pictures (15 png per second)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">ffmpeg -i ./carcamq2_1_1.mp4 -r 15 ./picture_%04d.png</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"># crop area=1920x100, started from x=0, y=550</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">for filename in ./picture_*.png ; do convert ${filename} -crop 1920x100+0+550 +repage ${filename} ; done</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">montage ./picture_*.png -border 1 -geometry +0+0 -tile 1x ./carcamq2_1_1-full.png</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">rm ./picture_*.png</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><br />— Вырезать из видео горизонтальную полосу, если ширина куска меньше 1920 — добавить черный фон по бокам:<br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"># video crop=width:heigth:pos_x:pos_y</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">ffmpeg -i gopro_2_1.mp4 -filter_complex &quot;[0:v]crop=1600:360:iw/3:ih/3 , pad=width=1920:height=ih:x=(1920-iw)/2:y=0:color=black&quot; ./gopro_2_1_crop.mp4</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><br />— Склеить видео из трех полосок в одно полнокадровое:<br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">ffmpeg -i gopro_2_1_crop.mp4 -i gopro_2_2_crop.mp4 -i gopro_2_3_crop.mp4 \</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">   -qscale 0 -filter_complex \</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">&quot;pad=1920:1080[tmp1]; \</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">[tmp1][0:v]overlay=0:0[tmp2]; \</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">[tmp2][1:v]overlay=300:360[tmp3]; \</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">[tmp3][2:v]overlay=500:720[out]&quot; -map &quot;[out]&quot; gopro_all.mp4</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><br />— Наложение прозрачного png поверх видео:<br /><span style=" font-family:'Courier New,courier';">ffmpeg -i test1_day.mp4 -i test1_overlay.png -qscale 0 -filter_complex &quot;[0:v][1:v]overlay=0:0[out]&quot; -map &quot;[out]&quot; test1_day_overlay.mp4</span><br /><br />— создать 5-секундную видео-вставку из готовой картинки<br /><span style=" font-family:'Courier New,courier';">ffmpeg -framerate 1/5 -i test1_day_overview.png -c:v libx264 -r 30 test1_day_overview.mp4</span><br /><br />Также могу порекомендовать сразу создать базу со списком видео-роликов и их характеристиками. Например я использовал легко-парсящийся в баше обычный .csv фаил, где были указаны пути, разрешения каждого ролика, центральная точка (линия горизонта и визуальный центр кадра), режим съемки, время нужного события и т.п. Благодаря этому очень просто делать скрипты, которые обрабатывают все ролики сразу, вырезая нужный в данный момент кусок, кропая нужной высоты картинку, склеивая их и т.д.</p></body></html>